# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура

В основе проекта и структуры его классов, используется паттерн _MVP_. Т.к. он обеспечивает хорошую архитектурную организацию, способствует слабой связанности между компонентами.

### Основные классы

#### Класс `EventEmitter`

`EventEmitter` — Класс для управления событиями, позволяет добавлять и удалять слушателей, а также вызывать их в момент возникновения событий.  

*Конструктор*: `constructor()`

*Параметры*:
- `_events: Map<EventName, Set<Subscriber>>` - Приватное свойство, содержащее набор подписчиков для каждого события.

*Методы*:
- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` - Назначает обработчик для указанного события;
- `off(eventName: EventName, callback: Subscriber)` - Удаляет обработчик из события;
- `emit<T extends object>(eventName: string, data?: T)` - Генерирует событие с определённым именем и возможными данными;
- `onAll(callback: (event: EmitterEvent) => void)` - Позволяет регистрировать слушатель для всех событий;
- `offAll()` - Удаляет всех слушателей;
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` - Вызывает колбек и генерирует событие по запросу.

*Типы данных*:
- `EventName` - Определяет название события;
- `Subscriber` - Определяет тип функции-обработчика события;
- `IEvents` - Интерфейс для управления событиями.

#### Класс `API`

`API` — Обеспечивает взаимодействие с данными, получаемыми с сервера, а также отвечает за отправку HTTP-запросов и обработку их ответов.

*Конструктор*:
`constructor(baseUrl: string, options: RequestInit)` - Конструктор принимает базовый URL и общие настройки для запросов.

*Свойства*:
- `readonly baseUrl: string` - Основной URL для отправки запросов к API;
- `protected options: RequestInit` - Базовые настройки для запросов.

*Методы*:
- `get<T>(uri: string): ApiResponse<T>` - Выполняет `GET` запросы по указанному URI и возвращает промис с ответом сервера;
- `post<T>(uri: string, data: object, method: ApiPostMethods): ApiResponse<T>` - Выполняет `POST` запросы с данными на указанный URI и возвращает промис с ответом.

*Типы данных*:
- `ApiPostMethods` - Определяет допустимые методы HTTP-запросов для `POST` запросов;
- `ApiResponse<T>` - Обобщённый тип данных для ответов API.

#### Класс `LarekAPI`

`LarekAPI` — Класс с методами для взаимодействия с сервером, позволяющий получать информацию о товарах как в общем, так и касательно конкретного товара, а также отправлять заказы на сервер. Он наследуется от класса `API`.

*Конструктор*:
`constructor(baseUrl, options)` - Принимает URL для API и параметры запроса.

*Методы*:
- `getProductList(): Promise<RemoteAPI.IProduct[]>` - Получает полный список товаров с сервера;
- `getProductItem(id: string): Promise<RemoteAPI.IProduct>` - Получает информацию о конкретном продукте по его `id`;
- `orderProducts(order: IOrder): Promise<RemoteAPI.IOrder>` - Отправляет информацию о заказе на сервер и получает результат.

*Типы данных*:
- `RemoteAPI.IProduct` - Данные о товаре;
- `IOrder` - Структура заказа;
- `RemoteAPI.IOrder` - Результата заказа;
- `IWebLarekAPI` - Методы `WebLarekAPI`.

#### Класс `Model`

`Model`  - Абстрактный класс, предназначен для работы с данными.

*Конструктор*:
`constructor(data, events)` - Принимает данные для модели и объект событий для уведомлений об изменениях модели.

*Методы*:
- `emitChanges(action, event)` - Оповещает всех слушателей об изменении модели.

*Типы данных*:
- `IEvents` - Интерфейс для управления событиями;

#### Класс `Component`

`Component` — Базовый класс для работы с DOM-элементами. Он предоставляет возможность:
- Отображать/скрывать элементы DOM;
- Изменять атрибуты элемента;
- Добавлять/удалять классы у элементов.

*Конструктор*:
`constructor(container: HTMLElement)` - Принимает контейнер, в котором создаётся элемент.

*Методы*:
- `toggleClass(element: HTMLElement, className: string)` - Включает или отключает класс на элементе;
- `toggleVisible (element: HTMLElement)` - Показывает/скрывает элемент;
- `setContent(element: HTMLElement, value: Record<string, any>)` - Устанавливает содержимое для элемента;
- `render(data)` - Рисует компонент.


### Классы для работы с данными

Эти классы предназначены для хранения данных о заказах, корзинах и карточках, полученных с сервера, а также для их отображения и обработки.

#### Класс `Product`

`Product` - Отвечает за хранение данных о продукте. Наследуется от `Model`.

*Конструктор*:
`constructor(data: RemoteAPI.IProduct)` - Принимает данные о товаре.

*Свойства*:
- `id: string` - Идентификатор продукта;
- `title: string` - Название товара;
- `price: number | null` - Цена товара;
- `description: string` - Описание товара;
- `category: string` - Категория товара;
- `image: string` - Изображение продукта.

*Типы данных*:
- `RemoteAPI.IProduct` - Данные о товаре.

#### Класс `App`

`App` - Служит основной моделью данных приложения, в которой хранятся каталог товаров, информация о заказе и ошибки валидации форм доставки и контакта. Будет наследоваться от `Model`.

*Конструктор*:
`constructor(data: IAppState)` - Принимающий начальное состояние приложения.

*Методы*:
- `addProduct(product: Product)` - Добавляет товар в корзину;
- `removeBasket()` - Удаляет корзину;
- `removeProduct(product: Product)` - Удаляет товар из корзины;
- `setCatalog(catalogs: IProduct[])` - Заполняет каталог товаров;
- `setPreview(product: Product)` - Устанавливает товар для предпросмотра;
- `setDelivery(data: IDelivery)` - Заполняет поля формы доставки;
- `setContact(data: IDelivery)` - Заполняет поля формы контакта.
- `removeOrder()` - Удаляет данные заказа;

*Свойства*:
- `basket: RemoteAPI.Product[]` - Массив товаров в корзине;
- `catalog: RemoteAPI.Product[]` - Массив товаров в каталоге;
- `order: IOrder` - Данные о заказе;
- `formErrors: FormErrors` - Ошибки валидации форм.

*Типы данных*:
- `IOrder` - Структуру заказа, включая информацию о способе оплаты, адресе доставки, электронной почте и номере телефона;
- `IDelivery` - Определяет поля формы заказа, связанных с данными о доставке;
- `FormErrors` - Структура хранения ошибок валидации форм;
- `IContact` - Контактные данные;
- `RemoteAPI.IProduct` - Данными о товаре.

### Классы для работы с отображением

Заполняют содержимое HTML-элементов и устанавливают обработчики событий на элементы, используя `EventEmitter`.

#### Класс `Form`

`Form` — Класс для работы с формами. Будет наследоваться от `Component`.

*Конструктор*:
`constructor(container: HTMLFormElement, events: IEvents)` - Принимает контейнер для формы и событие для управления.

*Свойства*:
- `submitForm: HTMLButtonElement` - Кнопка отправки формы;
- `errorOutput: HTMLElement` - Элемент для отображения ошибок валидации форм.

*Методы*:
- `set success(value: boolean)` - Cеттер для валидности формы, задает значение статуса success;
- `set error(value: string)` - Cеттер для ошибок валидации формы;
- `render(state: IFormState)` - Отображает состояние формы с заданными значениями валидности, ошибками и значениями полей;
- `onInputChange(field, value: string)` - Обработчик событий ввода, который генерирует события изменения для каждого поля.

*Типы данных*:
- `IFormState` - Состояния формы;

#### Класс `Modal`

`Modal` — предназначен для работы с модальными окнами. Будет наследоваться от `Component`.

*Конструктор*:
`constructor(container: HTMLElement, events: IEvents)` - Принимает контейнер для модального окна и событие для управления.  

*Свойства*:
- `closeButton: HTMLButtonElement` - Кнопка закрытия модального окна;
- `content: HTMLElement` - Контент модального окна.

*Методы*:
- `set content(value: HTMLElement)` - Сеттер для содержимого модального окна;
- `toggleModal()` - Открывает/закрывает модальное окно;
- `render(data: IModal)` - Рисует модальное окно.

*Типы данных*:
- `IModal` - информация для отображения в модальном окне.

#### Класс `Page`

`Page` - Предназначен для отображения и управления всеми элементами на странице, такими как каталог товаров и количество товаров в корзине. Будет наследоваться от `Component`.

*Конструктор*:
`constructor(container: HTMLElement, events: IEvents)` - Принимает контейнер для страницы и объект для управления событиями.

*Свойства*:
- `counter: HTMLElement;` - Счётчик корзины;
- `catalog: HTMLElement;` - Каталог товаров;

*Методы*:
- `set counter(value: number)` - Сеттер для изменения кол-ва товаров в корзине;
- `set catalogItems(items: HTMLElement[])` - Сеттер задает элементы каталога;

*Типы данных*:
- `IPage` - Интерфейс, описывающий структуры данных для компонента.

#### Класс `Card`

`Card` — Будет наследоваться от `Component`. Предназначенный для работы с карточкой товара, а точнее: 
 - Отображения, управления и создания экземпляров карточек в каталоге;
 - Отображения, управления и создания экземпляров карточек в корзине;
 - Обработка событий пользователя.

*Конструктор*:
`constructor(teamplate: HTMLElement, actions: IActions)` - Принимает шаблон карточки и действие.

*Свойства*:
- `id: number` - Идентификатор;
- `title: HTMLElement` - Заголовок;
- `description: HTMLElement` - Описание;
- `category: HTMLElement` - Элемент для категории товара;
- `price: HTMLElement` - Цена;
- `image: HTMLImageElement` - Картинка;
- `button: HTMLButtonElement` - Кнопка действия на карточке;

*Методы*:
- `set id(value: string)` - Сеттер идентификатора;
- `set title(value: string)` - Сеттер заголовка;
- `set description(value: string)` - Сеттер описания;
- `set category(value: string)` - Сеттер категории;
- `set price(value: number)` - Сеттер цены;
- `set image(value: string)` - Сеттер изображения;
- `get id()` - Геттер идентификатора;
- `get title()` - Геттер заголовка;
- `get category()` - Геттер категории;
- `get price()` - Геттер цены;

*Типы данных*:
- `ICard` - Данных для карточки товара;
- `IActions` - Действия, доступные для выполняемой карточки товара.

#### Класс `Basket`

`Basket` — Отвечает за отображение корзины, включающий список товаров и общую стоимость, а также управление их выбором. Будет наследоваться от `Component`.

*Конструктор*:
`constructor(container: HTMLElement, events)` - Принимающий контейнер и элемент для управления событиями.

*Свойства*:
- `result: HTMLElement` - Сообщение с деталями результата операции.
- `closeButton: HTMLElement` - Кнопка для закрытия сообщения;

*Методы класса*:
- `set result(value: string)` - Сеттер для сообщения об результате операции.

*Типы данных*:
- `IBasket` - Описывает структуру данных, используемую для отображения корзины.
